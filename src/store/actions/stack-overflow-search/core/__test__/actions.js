// TODO: unit-test core logic